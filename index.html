<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>唱片播放器交互</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #f0f0f0;
            overflow: hidden;
        }

        #svg-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        svg {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
        }
    </style>
</head>
<body>
    <div id="svg-container"></div>

    <!-- 音频元素 -->
    <audio id="weeknd-audio" src="After_Hours.mp3" loop></audio>
    <audio id="beatles-audio" src="Oh_Darling.mp3" loop></audio>
    <audio id="charlie-audio" src="We_Don't_Talk_Anymore.mp3" loop></audio>

    <script>
        // 加载 SVG 文件
        fetch('Recordplayer.svg')
            .then(response => response.text())
            .then(svgContent => {
                document.getElementById('svg-container').innerHTML = svgContent;
                initInteraction();
            })
            .catch(error => {
                console.error('加载 SVG 失败:', error);
            });

        function initInteraction() {
            // 获取元素
            const weekndCover = document.getElementById('Weeknd');
            const beatlesCover = document.getElementById('Beatles');
            const charlieCover = document.getElementById('Charlie');

            const weekndRecord = document.getElementById('WeekndRecord');
            const beatlesRecord = document.getElementById('BeatlesRecord');
            const charlieRecord = document.getElementById('CharlieRecord');

            const recordCenter = document.getElementById('RecordCenter');

            // 获取音频元素
            const weekndAudio = document.getElementById('weeknd-audio');
            const beatlesAudio = document.getElementById('beatles-audio');
            const charlieAudio = document.getElementById('charlie-audio');

            // 获取 RecordCenter 的位置
            const centerX = 1483;
            const centerY = 527;

            // 唱片的原始位置
            const recordPositions = {
                weeknd: { x: 872, y: 175 },
                beatles: { x: 871, y: 533 },
                charlie: { x: 870, y: 891 }
            };

            // 当前显示的唱片和音频
            let currentRecord = null;
            let currentAudio = null;

            // 移动唱片到中心并播放音乐的函数
            function moveRecordToCenter(record, recordName, audio) {
                if (!record) return;

                // 如果点击的是当前正在显示的唱片，则不做任何操作
                if (currentRecord === record) {
                    return;
                }

                // 停止之前的音乐
                if (currentAudio) {
                    currentAudio.pause();
                    currentAudio.currentTime = 0;
                }

                // 隐藏之前的唱片
                if (currentRecord) {
                    currentRecord.classList.remove('show');
                    currentRecord.style.transform = '';

                    // 等待动画完成后重置
                    setTimeout(() => {
                        if (currentRecord !== record) {
                            currentRecord.classList.remove('show');
                        }
                    }, 300);
                }

                // 计算移动距离
                const originalPos = recordPositions[recordName];
                const translateX = centerX - originalPos.x;
                const translateY = centerY - originalPos.y;

                // 显示并移动新唱片
                record.classList.add('show');

                // 使用 requestAnimationFrame 确保 transition 生效
                requestAnimationFrame(() => {
                    requestAnimationFrame(() => {
                        record.style.transform = `translate(${translateX}px, ${translateY}px)`;
                    });
                });

                // 播放新音乐
                if (audio) {
                    audio.play().catch(error => {
                        console.log('音频播放需要用户交互:', error);
                    });
                    currentAudio = audio;
                }

                currentRecord = record;
            }

            // 添加点击事件
            if (weekndCover) {
                weekndCover.addEventListener('click', () => {
                    moveRecordToCenter(weekndRecord, 'weeknd', weekndAudio);
                });
            }

            if (beatlesCover) {
                beatlesCover.addEventListener('click', () => {
                    moveRecordToCenter(beatlesRecord, 'beatles', beatlesAudio);
                });
            }

            if (charlieCover) {
                charlieCover.addEventListener('click', () => {
                    moveRecordToCenter(charlieRecord, 'charlie', charlieAudio);
                });
            }

            console.log('交互功能已初始化');
            console.log('点击左侧的专辑封面来查看唱片移动到播放器中心的动画效果，并播放对应的音乐');
        }
    </script>
</body>
</html>
